{% extends 'base.html' %}
{% block title %}{{ listing.title }} ‚Äî –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å –Ω–æ—Ç{% endblock %}
{% block content %}
  <div class="row">
    <div class="col-md-8">
      <h2>{{ listing.title }}</h2>
      <p class="text-muted">–ü—Ä–æ–¥–∞–≤–µ—Ü: {{ listing.seller }} ‚Ä¢ {{ listing.created_at.strftime('%Y-%m-%d') }}</p>
      <p>{{ listing.description }}</p>
    </div>
    <div class="col-md-4">
      <div class="card">
        <div class="card-body">
          <h4 class="card-title text-success">‚ÇΩ{{ '%.2f'|format(listing.price) }}</h4>
          <form method="post">
            <div class="mb-3">
              <label class="form-label">–í–∞—à–µ –∏–º—è</label>
              <input name="buyer" class="form-control" placeholder="–ò–º—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è">
            </div>
            <button class="btn btn-primary w-100" type="submit">–ö—É–ø–∏—Ç—å</button>
          </form>
        </div>
      </div>
      
      {% if user_can_access_file and listing.file_name %}
        <div class="card mt-3">
          <div class="card-body">
            <h5 class="card-title">üìé –§–∞–π–ª</h5>
            <p class="card-text">–í—ã –º–æ–∂–µ—Ç–µ —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª, —Ç–∞–∫ –∫–∞–∫:</p>
            <ul class="small">
              {% if listing.seller == current_user.username %}
                <li>–í—ã –ø—Ä–æ–¥–∞–≤–µ—Ü —ç—Ç–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</li>
              {% elif current_user.is_admin %}
                <li>–í—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</li>
              {% else %}
                <li>–í—ã –∫—É–ø–∏–ª–∏ —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä</li>
              {% endif %}
            </ul>
            <a href="{{ url_for('uploaded_file', filename=listing.file_name) }}" class="btn btn-outline-primary w-100">–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª</a>
          </div>
        </div>
      {% elif listing.file_name %}
        <div class="alert alert-info mt-3" role="alert">
          <strong>üí° –ö —ç—Ç–æ–º—É —Ç–æ–≤–∞—Ä—É –ø—Ä–∏–ª–∞–≥–∞–µ—Ç—Å—è —Ñ–∞–π–ª.</strong><br>
          –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø, –≤–∞–º –Ω—É–∂–Ω–æ –∫—É–ø–∏—Ç—å —Ç–æ–≤–∞—Ä.
        </div>
      {% endif %}
    </div>
  </div>
{% endblock %}
